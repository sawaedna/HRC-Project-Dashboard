"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/sheets";
exports.ids = ["pages/api/sheets"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "xlsx":
/*!***********************!*\
  !*** external "xlsx" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("xlsx");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\sheets.js */ \"(api)/./pages/api/sheets.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/sheets\",\n        pathname: \"/api/sheets\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNoZWV0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDc2hlZXRzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaHJjLWRhc2hib2FyZC1hci8/ZjM3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHNoZWV0cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/sheets.js":
/*!*****************************!*\
  !*** ./pages/api/sheets.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xlsx */ \"xlsx\");\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction normalizePercentCell(v) {\n    if (v == null) return 0;\n    if (typeof v === \"number\") return v > 1 ? v / 100 : v;\n    const s = String(v).trim().replace(\"%\", \"\").replace(\",\", \".\");\n    const n = parseFloat(s);\n    if (isNaN(n)) return 0;\n    return n > 1 ? n / 100 : n;\n}\nfunction readLocalExcel() {\n    const filePath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data.xlsx\");\n    if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(filePath)) throw new Error(\"Local Excel file not found: \" + filePath);\n    const buffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(filePath);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_0___default().read(buffer, {\n        type: \"buffer\"\n    });\n    const sheetName = workbook.SheetNames[0];\n    const rows = xlsx__WEBPACK_IMPORTED_MODULE_0___default().utils.sheet_to_json(workbook.Sheets[sheetName], {\n        defval: null,\n        raw: false\n    });\n    return rows.filter((row)=>Object.values(row).some((v)=>v !== null && v !== undefined && v !== \"\"));\n}\nfunction generateSummary(data) {\n    const map = {};\n    data.forEach((r)=>{\n        const site = r[\"الموقع\"] || \"غير محدد\";\n        if (!map[site]) map[site] = {\n            planned: [],\n            actual: [],\n            lat: r.Latitude || r.latitude || null,\n            lng: r.Longitude || r.longitude || null\n        };\n        map[site].planned.push(normalizePercentCell(r[\"النسبة المخططة (%)\"]));\n        map[site].actual.push(normalizePercentCell(r[\"النسبة الفعلية (%)\"]));\n    });\n    return Object.entries(map).map(([site, v])=>({\n            \"الموقع\": site,\n            \"متوسط النسبة المخططة\": v.planned.length ? v.planned.reduce((a, b)=>a + b, 0) / v.planned.length : 0,\n            \"متوسط النسبة الفعلية\": v.actual.length ? v.actual.reduce((a, b)=>a + b, 0) / v.actual.length : 0,\n            \"Latitude\": v.lat,\n            \"Longitude\": v.lng\n        }));\n}\nfunction calculateProjectDates(data) {\n    const starts = data.map((r)=>r[\"تاريخ البداية\"]).filter(Boolean).map((d)=>new Date(d)).map((dt)=>dt.getTime());\n    const ends = data.map((r)=>r[\"تاريخ النهاية\"]).filter(Boolean).map((d)=>new Date(d)).map((dt)=>dt.getTime());\n    if (!starts.length || !ends.length) return {\n        totalDays: 0,\n        elapsed: 0,\n        remaining: 0\n    };\n    const start = Math.min(...starts);\n    const end = Math.max(...ends);\n    const totalDays = Math.ceil((end - start) / (1000 * 60 * 60 * 24));\n    const elapsed = Math.max(0, Math.ceil((Date.now() - start) / (1000 * 60 * 60 * 24)));\n    const remaining = Math.max(0, totalDays - elapsed);\n    return {\n        totalDays,\n        elapsed,\n        remaining\n    };\n}\nasync function handler(req, res) {\n    try {\n        const data = readLocalExcel();\n        const summary = generateSummary(data);\n        const geo = summary.filter((s)=>s.Latitude != null && s.Longitude != null);\n        const projectDates = calculateProjectDates(data);\n        return res.status(200).json({\n            data: {\n                detailed: data,\n                summary,\n                geo,\n                projectDates\n            }\n        });\n    } catch (err) {\n        console.error(\"sheets API error\", err);\n        return res.status(500).json({\n            error: err.message || String(err)\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkIsc0JBQXNCbkI7UUFDM0MsT0FBT3VDLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRTVDLE1BQU07Z0JBQUU2QyxVQUFVN0M7Z0JBQU13QztnQkFBU0M7Z0JBQUtDO1lBQWE7UUFBRTtJQUNyRixFQUFFLE9BQU9JLEtBQUs7UUFDWkMsUUFBUUMsS0FBSyxDQUFDLG9CQUFvQkY7UUFDbEMsT0FBT1AsSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFSSxPQUFPRixJQUFJRyxPQUFPLElBQUlsRixPQUFPK0U7UUFBSztJQUNsRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaHJjLWRhc2hib2FyZC1hci8uL3BhZ2VzL2FwaS9zaGVldHMuanM/MDYwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgWExTWCBmcm9tICd4bHN4JztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG5mdW5jdGlvbiBub3JtYWxpemVQZXJjZW50Q2VsbCh2KSB7XHJcbiAgaWYgKHYgPT0gbnVsbCkgcmV0dXJuIDA7XHJcbiAgaWYgKHR5cGVvZiB2ID09PSAnbnVtYmVyJykgcmV0dXJuIHYgPiAxID8gdiAvIDEwMCA6IHY7XHJcbiAgY29uc3QgcyA9IFN0cmluZyh2KS50cmltKCkucmVwbGFjZSgnJScsICcnKS5yZXBsYWNlKCcsJywgJy4nKTtcclxuICBjb25zdCBuID0gcGFyc2VGbG9hdChzKTtcclxuICBpZiAoaXNOYU4obikpIHJldHVybiAwO1xyXG4gIHJldHVybiBuID4gMSA/IG4gLyAxMDAgOiBuO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWFkTG9jYWxFeGNlbCgpIHtcclxuICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YS54bHN4Jyk7XHJcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSkgdGhyb3cgbmV3IEVycm9yKCdMb2NhbCBFeGNlbCBmaWxlIG5vdCBmb3VuZDogJyArIGZpbGVQYXRoKTtcclxuICBjb25zdCBidWZmZXIgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgpO1xyXG4gIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGJ1ZmZlciwgeyB0eXBlOiAnYnVmZmVyJyB9KTtcclxuICBjb25zdCBzaGVldE5hbWUgPSB3b3JrYm9vay5TaGVldE5hbWVzWzBdO1xyXG4gIGNvbnN0IHJvd3MgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od29ya2Jvb2suU2hlZXRzW3NoZWV0TmFtZV0sIHsgZGVmdmFsOiBudWxsLCByYXc6IGZhbHNlIH0pO1xyXG4gIHJldHVybiByb3dzLmZpbHRlcihyb3cgPT4gT2JqZWN0LnZhbHVlcyhyb3cpLnNvbWUodiA9PiB2ICE9PSBudWxsICYmIHYgIT09IHVuZGVmaW5lZCAmJiB2ICE9PSAnJykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZVN1bW1hcnkoZGF0YSkge1xyXG4gIGNvbnN0IG1hcCA9IHt9O1xyXG4gIGRhdGEuZm9yRWFjaChyID0+IHtcclxuICAgIGNvbnN0IHNpdGUgPSByWyfYp9mE2YXZiNmC2LknXSB8fCAn2LrZitixINmF2K3Yr9ivJztcclxuICAgIGlmICghbWFwW3NpdGVdKSBtYXBbc2l0ZV0gPSB7IHBsYW5uZWQ6IFtdLCBhY3R1YWw6IFtdLCBsYXQ6IHIuTGF0aXR1ZGUgfHwgci5sYXRpdHVkZSB8fCBudWxsLCBsbmc6IHIuTG9uZ2l0dWRlIHx8IHIubG9uZ2l0dWRlIHx8IG51bGwgfTtcclxuICAgIG1hcFtzaXRlXS5wbGFubmVkLnB1c2gobm9ybWFsaXplUGVyY2VudENlbGwoclsn2KfZhNmG2LPYqNipINin2YTZhdiu2LfYt9ipICglKSddKSk7XHJcbiAgICBtYXBbc2l0ZV0uYWN0dWFsLnB1c2gobm9ybWFsaXplUGVyY2VudENlbGwoclsn2KfZhNmG2LPYqNipINin2YTZgdi52YTZitipICglKSddKSk7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKG1hcCkubWFwKChbc2l0ZSwgdl0pID0+ICh7XHJcbiAgICAn2KfZhNmF2YjZgti5Jzogc2l0ZSxcclxuICAgICfZhdiq2YjYs9i3INin2YTZhtiz2KjYqSDYp9mE2YXYrti32LfYqSc6IHYucGxhbm5lZC5sZW5ndGggPyB2LnBsYW5uZWQucmVkdWNlKChhLGIpPT5hK2IsMCkvdi5wbGFubmVkLmxlbmd0aCA6IDAsXHJcbiAgICAn2YXYqtmI2LPYtyDYp9mE2YbYs9io2Kkg2KfZhNmB2LnZhNmK2KknOiB2LmFjdHVhbC5sZW5ndGggPyB2LmFjdHVhbC5yZWR1Y2UoKGEsYik9PmErYiwwKS92LmFjdHVhbC5sZW5ndGggOiAwLFxyXG4gICAgJ0xhdGl0dWRlJzogdi5sYXQsXHJcbiAgICAnTG9uZ2l0dWRlJzogdi5sbmdcclxuICB9KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZVByb2plY3REYXRlcyhkYXRhKSB7XHJcbiAgY29uc3Qgc3RhcnRzID0gZGF0YS5tYXAociA9PiByWyfYqtin2LHZitiuINin2YTYqNiv2KfZitipJ10pLmZpbHRlcihCb29sZWFuKS5tYXAoZCA9PiBuZXcgRGF0ZShkKSkubWFwKGR0ID0+IGR0LmdldFRpbWUoKSk7XHJcbiAgY29uc3QgZW5kcyA9IGRhdGEubWFwKHIgPT4gclsn2KrYp9ix2YrYriDYp9mE2YbZh9in2YrYqSddKS5maWx0ZXIoQm9vbGVhbikubWFwKGQgPT4gbmV3IERhdGUoZCkpLm1hcChkdCA9PiBkdC5nZXRUaW1lKCkpO1xyXG4gIGlmICghc3RhcnRzLmxlbmd0aCB8fCAhZW5kcy5sZW5ndGgpIHJldHVybiB7IHRvdGFsRGF5czogMCwgZWxhcHNlZDogMCwgcmVtYWluaW5nOiAwIH07XHJcbiAgY29uc3Qgc3RhcnQgPSBNYXRoLm1pbiguLi5zdGFydHMpOyBjb25zdCBlbmQgPSBNYXRoLm1heCguLi5lbmRzKTtcclxuICBjb25zdCB0b3RhbERheXMgPSBNYXRoLmNlaWwoKGVuZCAtIHN0YXJ0KS8oMTAwMCo2MCo2MCoyNCkpO1xyXG4gIGNvbnN0IGVsYXBzZWQgPSBNYXRoLm1heCgwLCBNYXRoLmNlaWwoKERhdGUubm93KCkgLSBzdGFydCkvKDEwMDAqNjAqNjAqMjQpKSk7XHJcbiAgY29uc3QgcmVtYWluaW5nID0gTWF0aC5tYXgoMCwgdG90YWxEYXlzIC0gZWxhcHNlZCk7XHJcbiAgcmV0dXJuIHsgdG90YWxEYXlzLCBlbGFwc2VkLCByZW1haW5pbmcgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gcmVhZExvY2FsRXhjZWwoKTtcclxuICAgIGNvbnN0IHN1bW1hcnkgPSBnZW5lcmF0ZVN1bW1hcnkoZGF0YSk7XHJcbiAgICBjb25zdCBnZW8gPSBzdW1tYXJ5LmZpbHRlcihzID0+IHMuTGF0aXR1ZGUgIT0gbnVsbCAmJiBzLkxvbmdpdHVkZSAhPSBudWxsKTtcclxuICAgIGNvbnN0IHByb2plY3REYXRlcyA9IGNhbGN1bGF0ZVByb2plY3REYXRlcyhkYXRhKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGRhdGE6IHsgZGV0YWlsZWQ6IGRhdGEsIHN1bW1hcnksIGdlbywgcHJvamVjdERhdGVzIH0gfSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdzaGVldHMgQVBJIGVycm9yJywgZXJyKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnIubWVzc2FnZSB8fCBTdHJpbmcoZXJyKSB9KTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiWExTWCIsImZzIiwicGF0aCIsIm5vcm1hbGl6ZVBlcmNlbnRDZWxsIiwidiIsInMiLCJTdHJpbmciLCJ0cmltIiwicmVwbGFjZSIsIm4iLCJwYXJzZUZsb2F0IiwiaXNOYU4iLCJyZWFkTG9jYWxFeGNlbCIsImZpbGVQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJleGlzdHNTeW5jIiwiRXJyb3IiLCJidWZmZXIiLCJyZWFkRmlsZVN5bmMiLCJ3b3JrYm9vayIsInJlYWQiLCJ0eXBlIiwic2hlZXROYW1lIiwiU2hlZXROYW1lcyIsInJvd3MiLCJ1dGlscyIsInNoZWV0X3RvX2pzb24iLCJTaGVldHMiLCJkZWZ2YWwiLCJyYXciLCJmaWx0ZXIiLCJyb3ciLCJPYmplY3QiLCJ2YWx1ZXMiLCJzb21lIiwidW5kZWZpbmVkIiwiZ2VuZXJhdGVTdW1tYXJ5IiwiZGF0YSIsIm1hcCIsImZvckVhY2giLCJyIiwic2l0ZSIsInBsYW5uZWQiLCJhY3R1YWwiLCJsYXQiLCJMYXRpdHVkZSIsImxhdGl0dWRlIiwibG5nIiwiTG9uZ2l0dWRlIiwibG9uZ2l0dWRlIiwicHVzaCIsImVudHJpZXMiLCJsZW5ndGgiLCJyZWR1Y2UiLCJhIiwiYiIsImNhbGN1bGF0ZVByb2plY3REYXRlcyIsInN0YXJ0cyIsIkJvb2xlYW4iLCJkIiwiRGF0ZSIsImR0IiwiZ2V0VGltZSIsImVuZHMiLCJ0b3RhbERheXMiLCJlbGFwc2VkIiwicmVtYWluaW5nIiwic3RhcnQiLCJNYXRoIiwibWluIiwiZW5kIiwibWF4IiwiY2VpbCIsIm5vdyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzdW1tYXJ5IiwiZ2VvIiwicHJvamVjdERhdGVzIiwic3RhdHVzIiwianNvbiIsImRldGFpbGVkIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/sheets.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();