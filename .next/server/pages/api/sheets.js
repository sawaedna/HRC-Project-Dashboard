"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/sheets";
exports.ids = ["pages/api/sheets"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "xlsx":
/*!***********************!*\
  !*** external "xlsx" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("xlsx");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\sheets.js */ \"(api)/./pages/api/sheets.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/sheets\",\n        pathname: \"/api/sheets\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_sheets_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNoZWV0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDc2hlZXRzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaHJjLWRhc2hib2FyZC1hci8/MzIxOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHNoZWV0cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NoZWV0c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/sheets.js":
/*!*****************************!*\
  !*** ./pages/api/sheets.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xlsx */ \"xlsx\");\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction normalizePercentCell(v) {\n    if (v == null) return 0;\n    if (typeof v === \"number\") return v > 1 ? v / 100 : v;\n    const s = String(v).trim().replace(\"%\", \"\").replace(\",\", \".\");\n    const n = parseFloat(s);\n    if (isNaN(n)) return 0;\n    return n > 1 ? n / 100 : n;\n}\nfunction readLocalExcel() {\n    const filePath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data.xlsx\");\n    if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(filePath)) throw new Error(\"Local Excel file not found: \" + filePath);\n    const buffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(filePath);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_0___default().read(buffer, {\n        type: \"buffer\"\n    });\n    const sheetName = workbook.SheetNames[0];\n    const rows = xlsx__WEBPACK_IMPORTED_MODULE_0___default().utils.sheet_to_json(workbook.Sheets[sheetName], {\n        defval: null,\n        raw: false\n    });\n    return rows.filter((row)=>Object.values(row).some((v)=>v !== null && v !== undefined && v !== \"\"));\n}\nfunction generateSummary(data) {\n    const map = {};\n    data.forEach((r)=>{\n        const site = r[\"الموقع\"] || \"غير محدد\";\n        if (!map[site]) map[site] = {\n            planned: [],\n            actual: [],\n            lat: r.Latitude || r.latitude || null,\n            lng: r.Longitude || r.longitude || null\n        };\n        map[site].planned.push(normalizePercentCell(r[\"النسبة المخططة (%)\"]));\n        map[site].actual.push(normalizePercentCell(r[\"النسبة الفعلية (%)\"]));\n    });\n    return Object.entries(map).map(([site, v])=>({\n            \"الموقع\": site,\n            \"متوسط النسبة المخططة\": v.planned.length ? v.planned.reduce((a, b)=>a + b, 0) / v.planned.length : 0,\n            \"متوسط النسبة الفعلية\": v.actual.length ? v.actual.reduce((a, b)=>a + b, 0) / v.actual.length : 0,\n            \"Latitude\": v.lat,\n            \"Longitude\": v.lng\n        }));\n}\nfunction parseDate(v) {\n    if (!v) return null;\n    if (v instanceof Date && !isNaN(v)) return v.getTime();\n    if (typeof v === \"number\") {\n        // Excel serial date handling if raw=true was used, but here raw=false strings are expected.\n        return new Date(Math.round((v - 25569) * 86400 * 1000)).getTime();\n    }\n    const str = String(v).trim();\n    // Try YYYY-MM-DD or MM/DD/YYYY (standard JS)\n    let d = new Date(str);\n    if (!isNaN(d.getTime())) return d.getTime();\n    // Try DD/MM/YYYY\n    const parts = str.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{4})$/);\n    if (parts) {\n        const day = parseInt(parts[1], 10);\n        const month = parseInt(parts[2], 10) - 1;\n        const year = parseInt(parts[3], 10);\n        d = new Date(year, month, day);\n        if (!isNaN(d.getTime())) return d.getTime();\n    }\n    return null;\n}\nfunction calculateProjectDates(data) {\n    const starts = data.map((r)=>parseDate(r[\"تاريخ البداية\"])).filter((t)=>t !== null);\n    // Fixed value as per user request\n    const totalDays = 120;\n    let elapsed = 0;\n    if (starts.length > 0) {\n        const start = Math.min(...starts);\n        elapsed = Math.max(0, Math.ceil((Date.now() - start) / (1000 * 60 * 60 * 24)));\n    }\n    const remaining = Math.max(0, totalDays - elapsed);\n    return {\n        totalDays,\n        elapsed,\n        remaining\n    };\n}\nasync function handler(req, res) {\n    try {\n        const data = readLocalExcel();\n        const summary = generateSummary(data);\n        const geo = summary.filter((s)=>s.Latitude != null && s.Longitude != null);\n        const projectDates = calculateProjectDates(data);\n        return res.status(200).json({\n            data: {\n                detailed: data,\n                summary,\n                geo,\n                projectDates\n            }\n        });\n    } catch (err) {\n        console.error(\"sheets API error\", err);\n        return res.status(500).json({\n            error: err.message || String(err)\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixLQUFLcUIsR0FBRyxLQUFLSixLQUFJLElBQU0sUUFBTyxLQUFLLEtBQUssRUFBQztJQUM1RTtJQUVBLE1BQU1LLFlBQVlwQixLQUFLaUIsR0FBRyxDQUFDLEdBQUdKLFlBQVlDO0lBQzFDLE9BQU87UUFBRUQ7UUFBV0M7UUFBU007SUFBVTtBQUN6QztBQUVlLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJO1FBQ0YsTUFBTTdDLE9BQU8zQjtRQUNiLE1BQU15RSxVQUFVL0MsZ0JBQWdCQztRQUNoQyxNQUFNK0MsTUFBTUQsUUFBUXJELE1BQU0sQ0FBQzNCLENBQUFBLElBQUtBLEVBQUUwQyxRQUFRLElBQUksUUFBUTFDLEVBQUU2QyxTQUFTLElBQUk7UUFDckUsTUFBTXFDLGVBQWVoQixzQkFBc0JoQztRQUMzQyxPQUFPNkMsSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFbEQsTUFBTTtnQkFBRW1ELFVBQVVuRDtnQkFBTThDO2dCQUFTQztnQkFBS0M7WUFBYTtRQUFFO0lBQ3JGLEVBQUUsT0FBT0ksS0FBSztRQUNaQyxRQUFRQyxLQUFLLENBQUMsb0JBQW9CRjtRQUNsQyxPQUFPUCxJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVJLE9BQU9GLElBQUlHLE9BQU8sSUFBSXhGLE9BQU9xRjtRQUFLO0lBQ2xFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ocmMtZGFzaGJvYXJkLWFyLy4vcGFnZXMvYXBpL3NoZWV0cy5qcz8wNjA4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBYTFNYIGZyb20gJ3hsc3gnO1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZVBlcmNlbnRDZWxsKHYpIHtcclxuICBpZiAodiA9PSBudWxsKSByZXR1cm4gMDtcclxuICBpZiAodHlwZW9mIHYgPT09ICdudW1iZXInKSByZXR1cm4gdiA+IDEgPyB2IC8gMTAwIDogdjtcclxuICBjb25zdCBzID0gU3RyaW5nKHYpLnRyaW0oKS5yZXBsYWNlKCclJywgJycpLnJlcGxhY2UoJywnLCAnLicpO1xyXG4gIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpO1xyXG4gIGlmIChpc05hTihuKSkgcmV0dXJuIDA7XHJcbiAgcmV0dXJuIG4gPiAxID8gbiAvIDEwMCA6IG47XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlYWRMb2NhbEV4Y2VsKCkge1xyXG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdkYXRhLnhsc3gnKTtcclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZmlsZVBhdGgpKSB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsIEV4Y2VsIGZpbGUgbm90IGZvdW5kOiAnICsgZmlsZVBhdGgpO1xyXG4gIGNvbnN0IGJ1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCk7XHJcbiAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoYnVmZmVyLCB7IHR5cGU6ICdidWZmZXInIH0pO1xyXG4gIGNvbnN0IHNoZWV0TmFtZSA9IHdvcmtib29rLlNoZWV0TmFtZXNbMF07XHJcbiAgY29uc3Qgcm93cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3JrYm9vay5TaGVldHNbc2hlZXROYW1lXSwgeyBkZWZ2YWw6IG51bGwsIHJhdzogZmFsc2UgfSk7XHJcbiAgcmV0dXJuIHJvd3MuZmlsdGVyKHJvdyA9PiBPYmplY3QudmFsdWVzKHJvdykuc29tZSh2ID0+IHYgIT09IG51bGwgJiYgdiAhPT0gdW5kZWZpbmVkICYmIHYgIT09ICcnKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlU3VtbWFyeShkYXRhKSB7XHJcbiAgY29uc3QgbWFwID0ge307XHJcbiAgZGF0YS5mb3JFYWNoKHIgPT4ge1xyXG4gICAgY29uc3Qgc2l0ZSA9IHJbJ9in2YTZhdmI2YLYuSddIHx8ICfYutmK2LEg2YXYrdiv2K8nO1xyXG4gICAgaWYgKCFtYXBbc2l0ZV0pIG1hcFtzaXRlXSA9IHsgcGxhbm5lZDogW10sIGFjdHVhbDogW10sIGxhdDogci5MYXRpdHVkZSB8fCByLmxhdGl0dWRlIHx8IG51bGwsIGxuZzogci5Mb25naXR1ZGUgfHwgci5sb25naXR1ZGUgfHwgbnVsbCB9O1xyXG4gICAgbWFwW3NpdGVdLnBsYW5uZWQucHVzaChub3JtYWxpemVQZXJjZW50Q2VsbChyWyfYp9mE2YbYs9io2Kkg2KfZhNmF2K7Yt9i32KkgKCUpJ10pKTtcclxuICAgIG1hcFtzaXRlXS5hY3R1YWwucHVzaChub3JtYWxpemVQZXJjZW50Q2VsbChyWyfYp9mE2YbYs9io2Kkg2KfZhNmB2LnZhNmK2KkgKCUpJ10pKTtcclxuICB9KTtcclxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMobWFwKS5tYXAoKFtzaXRlLCB2XSkgPT4gKHtcclxuICAgICfYp9mE2YXZiNmC2LknOiBzaXRlLFxyXG4gICAgJ9mF2KrZiNiz2Lcg2KfZhNmG2LPYqNipINin2YTZhdiu2LfYt9ipJzogdi5wbGFubmVkLmxlbmd0aCA/IHYucGxhbm5lZC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIHYucGxhbm5lZC5sZW5ndGggOiAwLFxyXG4gICAgJ9mF2KrZiNiz2Lcg2KfZhNmG2LPYqNipINin2YTZgdi52YTZitipJzogdi5hY3R1YWwubGVuZ3RoID8gdi5hY3R1YWwucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyB2LmFjdHVhbC5sZW5ndGggOiAwLFxyXG4gICAgJ0xhdGl0dWRlJzogdi5sYXQsXHJcbiAgICAnTG9uZ2l0dWRlJzogdi5sbmdcclxuICB9KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBhcnNlRGF0ZSh2KSB7XHJcbiAgaWYgKCF2KSByZXR1cm4gbnVsbDtcclxuICBpZiAodiBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKHYpKSByZXR1cm4gdi5nZXRUaW1lKCk7XHJcbiAgaWYgKHR5cGVvZiB2ID09PSAnbnVtYmVyJykge1xyXG4gICAgLy8gRXhjZWwgc2VyaWFsIGRhdGUgaGFuZGxpbmcgaWYgcmF3PXRydWUgd2FzIHVzZWQsIGJ1dCBoZXJlIHJhdz1mYWxzZSBzdHJpbmdzIGFyZSBleHBlY3RlZC5cclxuICAgIHJldHVybiBuZXcgRGF0ZShNYXRoLnJvdW5kKCh2IC0gMjU1NjkpICogODY0MDAgKiAxMDAwKSkuZ2V0VGltZSgpO1xyXG4gIH1cclxuICBjb25zdCBzdHIgPSBTdHJpbmcodikudHJpbSgpO1xyXG4gIC8vIFRyeSBZWVlZLU1NLUREIG9yIE1NL0REL1lZWVkgKHN0YW5kYXJkIEpTKVxyXG4gIGxldCBkID0gbmV3IERhdGUoc3RyKTtcclxuICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQuZ2V0VGltZSgpO1xyXG5cclxuICAvLyBUcnkgREQvTU0vWVlZWVxyXG4gIGNvbnN0IHBhcnRzID0gc3RyLm1hdGNoKC9eKFxcZHsxLDJ9KVtcXC9cXC1dKFxcZHsxLDJ9KVtcXC9cXC1dKFxcZHs0fSkkLyk7XHJcbiAgaWYgKHBhcnRzKSB7XHJcbiAgICBjb25zdCBkYXkgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApO1xyXG4gICAgY29uc3QgbW9udGggPSBwYXJzZUludChwYXJ0c1syXSwgMTApIC0gMTtcclxuICAgIGNvbnN0IHllYXIgPSBwYXJzZUludChwYXJ0c1szXSwgMTApO1xyXG4gICAgZCA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xyXG4gICAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkLmdldFRpbWUoKTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZVByb2plY3REYXRlcyhkYXRhKSB7XHJcbiAgY29uc3Qgc3RhcnRzID0gZGF0YS5tYXAociA9PiBwYXJzZURhdGUoclsn2KrYp9ix2YrYriDYp9mE2KjYr9in2YrYqSddKSkuZmlsdGVyKHQgPT4gdCAhPT0gbnVsbCk7XHJcbiAgLy8gRml4ZWQgdmFsdWUgYXMgcGVyIHVzZXIgcmVxdWVzdFxyXG4gIGNvbnN0IHRvdGFsRGF5cyA9IDEyMDtcclxuXHJcbiAgbGV0IGVsYXBzZWQgPSAwO1xyXG4gIGlmIChzdGFydHMubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1pbiguLi5zdGFydHMpO1xyXG4gICAgZWxhcHNlZCA9IE1hdGgubWF4KDAsIE1hdGguY2VpbCgoRGF0ZS5ub3coKSAtIHN0YXJ0KSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSkpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVtYWluaW5nID0gTWF0aC5tYXgoMCwgdG90YWxEYXlzIC0gZWxhcHNlZCk7XHJcbiAgcmV0dXJuIHsgdG90YWxEYXlzLCBlbGFwc2VkLCByZW1haW5pbmcgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gcmVhZExvY2FsRXhjZWwoKTtcclxuICAgIGNvbnN0IHN1bW1hcnkgPSBnZW5lcmF0ZVN1bW1hcnkoZGF0YSk7XHJcbiAgICBjb25zdCBnZW8gPSBzdW1tYXJ5LmZpbHRlcihzID0+IHMuTGF0aXR1ZGUgIT0gbnVsbCAmJiBzLkxvbmdpdHVkZSAhPSBudWxsKTtcclxuICAgIGNvbnN0IHByb2plY3REYXRlcyA9IGNhbGN1bGF0ZVByb2plY3REYXRlcyhkYXRhKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGRhdGE6IHsgZGV0YWlsZWQ6IGRhdGEsIHN1bW1hcnksIGdlbywgcHJvamVjdERhdGVzIH0gfSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdzaGVldHMgQVBJIGVycm9yJywgZXJyKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnIubWVzc2FnZSB8fCBTdHJpbmcoZXJyKSB9KTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiWExTWCIsImZzIiwicGF0aCIsIm5vcm1hbGl6ZVBlcmNlbnRDZWxsIiwidiIsInMiLCJTdHJpbmciLCJ0cmltIiwicmVwbGFjZSIsIm4iLCJwYXJzZUZsb2F0IiwiaXNOYU4iLCJyZWFkTG9jYWxFeGNlbCIsImZpbGVQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJleGlzdHNTeW5jIiwiRXJyb3IiLCJidWZmZXIiLCJyZWFkRmlsZVN5bmMiLCJ3b3JrYm9vayIsInJlYWQiLCJ0eXBlIiwic2hlZXROYW1lIiwiU2hlZXROYW1lcyIsInJvd3MiLCJ1dGlscyIsInNoZWV0X3RvX2pzb24iLCJTaGVldHMiLCJkZWZ2YWwiLCJyYXciLCJmaWx0ZXIiLCJyb3ciLCJPYmplY3QiLCJ2YWx1ZXMiLCJzb21lIiwidW5kZWZpbmVkIiwiZ2VuZXJhdGVTdW1tYXJ5IiwiZGF0YSIsIm1hcCIsImZvckVhY2giLCJyIiwic2l0ZSIsInBsYW5uZWQiLCJhY3R1YWwiLCJsYXQiLCJMYXRpdHVkZSIsImxhdGl0dWRlIiwibG5nIiwiTG9uZ2l0dWRlIiwibG9uZ2l0dWRlIiwicHVzaCIsImVudHJpZXMiLCJsZW5ndGgiLCJyZWR1Y2UiLCJhIiwiYiIsInBhcnNlRGF0ZSIsIkRhdGUiLCJnZXRUaW1lIiwiTWF0aCIsInJvdW5kIiwic3RyIiwiZCIsInBhcnRzIiwibWF0Y2giLCJkYXkiLCJwYXJzZUludCIsIm1vbnRoIiwieWVhciIsImNhbGN1bGF0ZVByb2plY3REYXRlcyIsInN0YXJ0cyIsInQiLCJ0b3RhbERheXMiLCJlbGFwc2VkIiwic3RhcnQiLCJtaW4iLCJtYXgiLCJjZWlsIiwibm93IiwicmVtYWluaW5nIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInN1bW1hcnkiLCJnZW8iLCJwcm9qZWN0RGF0ZXMiLCJzdGF0dXMiLCJqc29uIiwiZGV0YWlsZWQiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/sheets.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsheets&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csheets.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();